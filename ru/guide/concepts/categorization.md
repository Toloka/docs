# Классификация изображений

{% include [deprecate](../../_includes/deprecate.md) %}

[Проекты](../../glossary.md#project) с типом классификация предназначены для заданий с конечным количеством вариантов ответа. Например, модерация контента или распределение изображений по заданным категориям.

Возможно, для вашего задания нужны дополнительные проекты, например предварительная проверка датасета или проверка ответов исполнителей. Подробнее об этом читайте в разделе [Декомпозиция задания](solution-architecture.md).

Предположим, вы хотите распределить фотографии с изображением котов по группам — хорошее настроение у кота или плохое. Создадим задание: исполнитель смотрит на картинку и выбирает вариант ответа.

{% note tip %}

Сначала запустите проект в [Песочнице]({{ sandbox }}). Так вы сможете избежать ошибок и потраченных средств, если окажется, что ваше задание не работает.

{% endnote %}

{% cut "Пример готового задания" %}

![](../_images/tutorials/categorization/cat_example.png)

{% endcut %}

Чтобы запустить задания и получить ответы:

1. [Создайте проект](#project)
1. [Добавьте пул заданий](#pool)
1. [Загрузите задания](#tasks_upload)
1. [Настройте контроль качества](#quality_control)
1. [Добавьте обучение](#training)
1. [Запустите пул и получите результаты](#launch)

## Создайте проект {#project}

{% include [toloka-requester-source-project-def](../_includes/toloka-requester-source/id-toloka-requester-source/project-def.md) %}

#### В интерфейсе:

1. Выберите пресет:

    1. {% include [toloka-requester-source-create-project](../_includes/toloka-requester-source/id-toloka-requester-source/create-project.md) %}

    1. {% include [toloka-requester-source-template-image-specification](../_includes/toloka-requester-source/id-toloka-requester-source/template-image-specification.md) %}

1. Заполните общую информацию:

    1. Дайте проекту понятное название и краткое описание. Их увидят исполнители в списке доступных заданий.

    1. По желанию добавьте **Приватный комментарий**.

    1. Нажмите **Сохранить**.

1. {% include [toloka-requester-source-edit-interface](../_includes/toloka-requester-source/id-toloka-requester-source/edit-interface.md) %}

    {% list tabs %}

    - Конструктор шаблонов

      1. {% include [toloka-requester-source-interface-def](../_includes/toloka-requester-source/id-toloka-requester-source/interface-def.md) %}

          Для этого проекта воспользуйтесь готовым шаблоном, где уже настроена валидация, горячие клавиши и внешний вид задания. Исполнитель не сможет отправить задание, если не выберет варианта ответа.

          Подробнее в Справке конструктора шаблонов:

          - [настройка условий](../../template-builder/best-practices/conditions.md);

          - шаблон [Классификация изображений](../../template-builder/templates/image-classification.md).

      1. {% include [toloka-requester-source-tb-input-output_1](../_includes/toloka-requester-source/id-toloka-requester-source/tb-input-output_1.md) %}

          В данном проекте:

          - Поле входных данных: `image` — ссылка для загрузки картинки.

              Измените тип данных на строку, чтобы использовать ссылки на свои файлы{% if locale == "ru-ru" %} или [загружать картинки](prepare-data.md#interface), хранящиеся на Яндекс Диске{% endif %}.

          - Поле выходных данных: `result` — строка, в которую будет записан ответ исполнителя.

    - Редактор HTML/CSS/JS

      1. {% include [toloka-requester-source-interface-def](../_includes/toloka-requester-source/id-toloka-requester-source/interface-def.md) %}

          {% include [toloka-requester-source-interface-html](../_includes/toloka-requester-source/id-toloka-requester-source/interface-html.md) %}

          1. В блоке **Интерфейс задания** отредактируйте блок **HTML**. После строки с изображением добавьте вопрос: {% if locale == "ru-ru" %}

              ```html
              {{img src=image width="100%" height="400px"}}
              <div>Какое у кота настроение</b>?<div>
              ```

              {% endif %}{% if locale == "en-com" %}

              ```html
              {{img src=image width="100%" height="400px"}}
              <div>What's the cat's mood</b>?<div>
              ```

              {% endif %}

          1. Для этого проекта оставьте блоки **JS** и **CSS** без изменений.

      1. В блоке **Спецификация данных** задаются поля входных и выходных данных.

          {% cut "Что такое входные и выходные данные?" %}

          {% include [toloka-requester-source-input-data](../_includes/toloka-requester-source/id-toloka-requester-source/input-data.md) %}

          {% include [toloka-requester-source-output-data](../_includes/toloka-requester-source/id-toloka-requester-source/output-data.md) %}

          {% endcut %}

          {% include [categorization-tb-input-output_1](../_includes/concepts/categorization/id-categorization/tb-input-output_1.md) %}

      1. Нажмите кнопку ![](../_images/tutorials/image-segmentation/preview-button.svg), чтобы увидеть получившееся задание.

          {% note info %}

          В предварительном просмотре проекта отображается одно задание со стандартными данными. Количество заданий на странице вы сможете настроить далее.

          {% endnote %}

          Проверьте работу опций задания. В правом нижнем углу **Отправить**.

          Чтобы выйти из режима предпросмотра, внизу слева нажмите **Выйти**. Если при тестировании задания были ошибки — проверьте блоки кода, которые вы вводили.

      1. {% include [toloka-requester-source-save](../_includes/toloka-requester-source/id-toloka-requester-source/save.md) %}

    {% endlist %}

1. Напишите краткую и ясную инструкцию. Опишите в ней, что надо сделать, и приведите примеры.

    Вы можете подготовить инструкцию в формате HTML и вставить ее в редактор. Чтобы переключиться в режим HTML, нажмите **<>**.

   1. Нажмите **Завершить**.

Подробнее о работе с проектом читайте в разделе [Проект](project.md).

## Добавьте пул заданий {#pool}

Пул — это набор оплачиваемых заданий, которые одновременно выдаются исполнителям.

1. Откройте проект и нажмите **Добавить пул**.

1. Дайте пулу любое удобное название — оно доступно только вам, исполнитель увидит название проекта.

1. В блоке **Аудитория** добавьте **Фильтры** для отбора исполнителей. Чтобы ваше задание было доступно только исполнителям, владеющим русским языком, установите язык и страну по номеру телефона.

    {% include [toloka-requester-source-filter-client-about](../_includes/toloka-requester-source/id-toloka-requester-source/filter-client-about.md) %}

    ![](../_images/other/filters.png)

1. В блоке **Цена** установите цену за страницу заданий, например `0.02`.

    {% cut "Что такое страница заданий?" %}

    На одной странице может отображаться одно или несколько заданий. Если задания простые, то можно добавлять 10–20 заданий на одну страницу. Не рекомендуем создавать длинные страницы, поскольку это снизит скорость загрузки данных у исполнителя.

    Исполнитель получит оплату, только если выполнил все задания на странице.

    Количество заданий на странице вы определите при [загрузке заданий](#smart-mixing).

    {% endcut %}

    {% cut "Как определить справедливую цену?" %}

    Общее правило формирования цены — чем больше времени исполнитель тратит на выполнение, тем выше цена.

    Вы можете зарегистрироваться в Толоке как исполнитель и узнать, сколько платят другие заказчики за задания.

    {% endcut %}

1. В блоке **Контроль качества** установите **Перекрытие задания** — количество исполнителей, которые должны выполнить задание. Для заданий классификации достаточно перекрытия — 3.

1. В блоке **Дополнительные настройки** укажите **Время на страницу заданий**. Его должно быть достаточно, в том числе для чтения инструкции и загрузки задания. Например, 600 секунд.

1. Нажмите кнопку **Создать пул**.

## Загрузите задания {#tasks_upload}

{% include [toloka-requester-source-tsv-file](../_includes/toloka-requester-source/id-toloka-requester-source/tsv-file.md) %}

1. Нажмите кнопку {% if locale == "ru-ru" %}**Загрузить**{% elsif locale == "en-com" %}**Upload**{% endif %}. В открывшемся окне вы можете скачать шаблон файла.

    #### Использовать пример данных

    Если вы хотите посмотреть, как ваш проект будет выглядеть после запуска, но у вас еще нет заданий для разметки, вы можете загрузить в пул готовый пример данных.

    Нажмите {% if locale == "ru-ru" %}**Использовать пример данных**{% elsif locale == "en-com" %}**Use sample data**{% endif %} справа от надписи {% if locale == "ru-ru" %}**Прикрепите подготовленный файл с данными**{% elsif locale == "en-com" %}**Attach the prepared file with data**{% endif %}. Это позволит избежать дополнительных действий с файлами.

    После того, как вы поработали с примером данных и вас все устроило, подготовьте свои данные и загрузите их в пул.

1. Добавьте в файл входные данные. Заголовок столбца с входными данными содержит слово `INPUT`. Остальные столбцы оставьте пустыми.

    ![](../_images/tutorials/categorization/cats_tsv_text.png)

1. Загрузите задания, выбрав **Умное смешивание** и указав количество заданий на странице. Например: 9 [основных](../../glossary.md#general-task) и 1 контрольное.

    {% cut "Что такое умное смешивание?" %}

    **Умное смешивание** случайным образом формирует страницы с заданиями так, чтобы задания не повторялись для каждого исполнителя.

    {% endcut %}

1. Добавьте контрольные задания. Для этого нажмите **Разметить** и укажите правильные ответы у нескольких заданий.

    {% note info %}

    Если вместо **умного смешивания** было выбрано другое, необходимо нажать кнопку **Разметить**. Если такой кнопки нет, удалите файл и загрузите заново.

    {% endnote %}

    {% cut "Что такое контрольные задания?" %}

    Контрольные задания — это задания с заранее известным ответом. Они нужны, чтобы следить за качеством ответов исполнителя. Заданный вами ответ сравнивается с ответом исполнителя, и если они не совпадают, значит исполнитель ответил неверно.

    Контрольных заданий должно быть [не менее 1%](../troubleshooting/pool-setup.md#why-one-percent) от общего числа заданий, то есть на 1000 заданий нужно добавить минимум 10 контрольных.

    Подробнее о [контрольных заданиях](goldenset.md).

    {% endcut %}

## Настройте контроль качества {#quality_control}

[Блоки контроля качества](control.md) позволяют отсеивать невнимательных исполнителей. Контроль качества можно настраивать как в проекте, так и в пуле.

{% note alert %}

Настройки контроля качества в проекте будут действовать во всех пулах проекта, и изменить их настройку в одном из пулов будет невозможно.

При [клонировании проекта](project.md) настройки контроля качества проекта не переносятся.

{% endnote %}

1. {% include [control_how-setQC](../_includes/concepts/control/id-control_how/setQC.md) %}

1. Добавьте блок **Контрольные задания** и укажите следующие значения:

    ![](../_images/tutorials/categorization/quality_goldenset.png)

    Это означает, что если исполнитель даст больше 40% неправильных ответов на контрольные вопросы, то он будет заблокирован и не сможет больше выполнять задания этого проекта в течение пяти дней.

1. Добавьте блок **Быстрые ответы**.

    Значение параметра **Минимальное время на страницу** зависит от количества заданий на этой странице. Чтобы определить настроение кота, достаточно 2–4 секунды. Значит, на страницу с 10-ю заданиями может хватить 20–30 секунд.

    Один раз можно ошибиться неумышленно, а вот после 2–3 закономерных раз можно и заблокировать исполнителя на какое-то время.

    Укажите следующие значения:

    ![](../_images/other/fast-answers2.png)

    Это означает, что если исполнитель выполнит 2 страницы заданий быстрее чем за 20 секунд, он будет заблокирован и не сможет больше выполнять ваши задания 10 дней.

    {% include [ban-banned-user-answers-note](../_includes/concepts/ban/id-ban/banned-user-answers-note.md) %}

## Добавьте обучение {#training}

Создайте [обучающий пул](../../glossary.md#training-pool):

1. Откройте страницу [проекта](../../glossary.md#project).

1. Перейдите на вкладку {% if locale == "ru-ru" %}**Обучения**{% elsif locale == "en-com" %}**Training**{% endif %}

1. Нажмите кнопку {% if locale == "ru-ru" %}**Добавить обучение**{% elsif locale == "en-com" %}**Add training**{% endif %}.

1. Заполните поля с [настройками обучения](train.md).

    С помощью поля {% if locale == "ru-ru" %}**Повторное прохождение**{% elsif locale == "en-com" %}**Retry after**{% endif %} вы можете настроить [переобучение](train.md).

1. Нажмите кнопку {% if locale == "ru-ru" %}**Сохранить обучение**{% elsif locale == "en-com" %}**Save training**{% endif %}.

После создания обучающего пула:

1. Скачайте **шаблон задания** или отредактируйте тот, в котором загружали задания для основного пула.

    {% note info %}

    Файлы с заданиями для всех пулов одного проекта имеют одинаковую структуру.

    {% endnote %}

1. Добавьте в файл с заданиями ссылки на картинки для обучающих заданий.

1. Загрузите файл, указав количество заданий на странице. Например, 10. Это число не должно превышать количество заданий на странице в основном пуле.

1. Нажмите **Загрузить** и укажите количество обучающих заданий на странице.

1. Нажмите **Добавить**.

1. Нажмите кнопку **Разметить**, а затем кнопку **Создать обучающие**. Далее добавьте правильный ответ и подсказку для всех загруженных заданий.

    ![](../_images/tutorials/categorization/cat-edit.png)

1. После успешной загрузки откройте **Предпросмотр** и проверьте, что задания отображаются корректно.

1. Откройте основной пул с заданиями, привяжите **Обучение** и установите **Уровень прохождения** 55. Тогда пул будет доступен исполнителям, допустившим не более 45% ошибок при обучении.

    Чтобы выполнить привязку, зайдите в режим редактирования основного пула и в выпадающем списке параметра **Обучение** выберите ваш обучающий пул.

Подробнее [о создании пула с обучением](train.md).

## Запустите пул и получите результаты {#launch}

1. Запустите пул, нажав кнопку ![](../_images/other/b-start-pool.svg).

1. Следите за выполнением в блоке **Статистика пула**.

1. Запустите агрегацию результатов, когда пул будет полностью выполнен. Для этого около кнопки **Скачать результаты** нажмите {% if locale == "ru-ru" %}**![Выпадающее меню](../_images/other/drop-down.svg) → Агрегация результатов по методу Дэвида — Скина**{% endif %}{% if locale == "en-com" %}**![Drop-down button](../_images/other/drop-down.svg) → Dawid-Skene aggregation model**{% endif %}.

    Агрегация ответов нужна для того, чтобы у вас была полная картина по всем результатам. Подробнее [об агрегации](result-aggregation.md).

1. Отслеживайте ход агрегации на странице **Операции**. По завершении нажмите кнопку **Скачать**.

## Решение проблем {#troubleshooting}

{% if locale == "ru-ru" %}

{% cut "Загрузка файлов с Яндекс Диска" %}

{% cut "Не загружаются файлы с Яндекс Диска" %}

Если картинки, аудио или видео с Яндекс Диска не отображаются в [инструкции](../../glossary.md#instructions) или на [странице задания](../../glossary.md#task-suite), убедитесь, что вы правильно подключили Диск и загрузили файлы.

- [Как подключить Яндекс Диск](prepare-data.md#prepare-data__connect)
- [Как загрузить файлы для инструкции](prepare-data.md#prepare-data__instruction)
- [Как загрузить файлы для задания](prepare-data.md#prepare-data__interface)

{% cut " Как сделать задание, в котором исполнитель должен просматривать видео с Яндекс Диска?" %}

Для создания задания возьмите за основу [шаблон для разметки видео]({{ templates-video-new }}).

Чтобы разместить ваши видеоролики на Яндекс Диске, его нужно подключить и настроить проект.

{% if locale == "ru-ru" %}

Подробная видеоинструкция об этом [в нашем блоге]({{ toloka-blog-yadisk }}).

{% endif %}

{% endcut %}

{% cut "Почему в задании по выделению объектов на изображении не отображаются изображения с Яндекс Диска?" %}

Проблема в шаблоне задания. Проверьте, что:

- Для поля входных данных, куда вы передаете ссылку на файл, в проекте указан тип «строка».

- В компоненте в шаблоне задания используется выражение proxy.

- Формат относительных ссылок в файле с заданиями указан верно: <уникальное имя>/<путь и имя файла>.

Подробная инструкцию и видео на странице [Использование файлов с Яндекс Диска](prepare-data.md).

{% endcut %}

{% if locale == "ru-ru" %}

{% cut "Частые ошибки при подключении Диска и загрузке файлов" %}

- В настройках проекта в поле **Входные данные** указан тип _ссылка_. Необходимо выбрать тип _строка_.

- В [файле с заданиями](../../glossary.md#tsv) указаны абсолютные ссылки на файлы для заданий. Необходимо вставить ссылку вида `<уникальное имя>/<путь и имя файла>`. Например: `yadisk/image1.jpg` или `yadisk/photos/image1.png`.

- Фото с Яндекс Диска используются в инструкции к заданию в мобильном приложении. Чтобы фото отобразилось в инструкции, используйте только прямые ссылки.

- Файлы удалены или находятся не в той папке на Диске, на которую ведет ссылка.

- OAuth-токен не активен. Обновите токен на странице [Интеграция]({{ integration }}).

Чтобы файлы, загруженные на Яндекс Диск (картинки, аудио, видео), отображались у исполнителя, нужно:

- Подключить Яндекс Диск в профиле.

- Установить тип строка для поля [входных данных](../../glossary.md#input-output-data).

- Вставлять ссылку на файл при помощи компонента `proxy`.

[Подробная инструкция](prepare-data.md)

{% endcut %}

{% endif %}

{% endcut %}

{% endif %}

{% cut "Файлы на Яндекс Диск загружаются слишком медленно. Как ускорить загрузку?" %}

Попробуйте воспользоваться рекомендациями с [этой страницы]({{ yadisk-uploading }}) или написать в службу поддержки Яндекс Диска.

{% endcut %}

{% cut "Частые ошибки при подключении Диска и загрузке файлов" %}

- В настройках проекта в поле **Входные данные** указан тип _ссылка_. Необходимо выбрать тип _строка_.

- В [файле с заданиями](../../glossary.md#tsv) указаны абсолютные ссылки на файлы для заданий. Необходимо вставить ссылку вида `<уникальное имя>/<путь и имя файла>`. Например: `yadisk/image1.jpg` или `yadisk/photos/image1.png`.

- Фото с Яндекс Диска используются в инструкции к заданию в мобильном приложении. Чтобы фото отобразилось в инструкции, используйте только прямые ссылки.

- Файлы удалены или находятся не в той папке на Диске, на которую ведет ссылка.

- OAuth-токен не активен. Обновите токен на странице [Интеграция]({{ integration }}).

Чтобы файлы, загруженные на Яндекс Диск (картинки, аудио, видео), отображались у исполнителя, нужно:

- Подключить Яндекс Диск в профиле.

- Установить тип строка для поля [входных данных](../../glossary.md#input-output-data).

- Вставлять ссылку на файл при помощи компонента `proxy`.

[Подробная инструкция](prepare-data.md)

{% endcut %}

{% cut "Почему в предпросмотре заданий не отображаются изображения с Яндекс Диска?" %}

Проблема в шаблоне задания. Проверьте, что:

- Для поля входных данных, куда вы передаете ссылку на файл, в проекте указан тип «строка».

- В компоненте в шаблоне задания используется выражение proxy.

- Формат относительных ссылок в файле с заданиями указан верно: <уникальное имя>/<путь и имя файла>.

{% if locale == "ru-ru" %}

Подробная [инструкция и видео](prepare-data.md).

{% elsif locale == "en-com" %}

Подробная [инструкция](prepare-data.md).

{% endif %}

{% endcut %}

{% cut "Как в инструкцию встроить несколько картинок с помощью ссылок на Яндекс Диск?" %}

Чтобы добавить картинки с помощью ссылок на Яндекс Диск:

- Используйте ссылку, например: /api/proxy/yadisk/image1.jpg .

- В настройках профиля заказчика перейдите в .

- Настройте интеграцию с внешними сервисами.

    [Подробно об использовании файлов с Яндекс Диска](prepare-data.md).

{% endcut %}

{% endcut %}

{% cut "Почему при загрузке задания, в котором нужно просмотреть изображение и написать фидбэк, появляется ошибка синтаксиса?" %}

Ошибка будет возникать, если на вход ожидается тип URL, а приходит строка.

Причин может быть две:

- Входное поле имеет тип "ссылка".

- Пул работает на неактуальной версии проекта. То есть создан до того, как вы изменили тип входного поля.

{% endcut %}

{% cut "Почему в задании с классификацией фотографий, если на странице больше 5-ти фотографий, то Толока разделяет их на 2 страницы?" %}

Загруженные ссылки на картинки в файле Толока разделит на страницы в зависимости от того, какой способ распределения заданий вы выбрали. Подробнее читайте на странице [Способы распределения заданий](distribute-tasks-by-pages.md).

{% endcut %}

{% cut "Как сделать так, чтобы при нажатии на изображение оно увеличивалось максимально?" %}

Добавьте к компоненту для вставки картинки параметры `real-size=true` и `screenshot=true`.

{% endcut %}

{% cut "Нужно ли подгонять все изображения для задания под один размер, или они могут быть разные?" %}

Размеры изображений могут быть разные.

{% endcut %}

{% include [contact-support](../_includes/contact-support.md) %}