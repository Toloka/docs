# Яндекс Диск

{% include [deprecate](../../_includes/deprecate.md) %}

{% note info %}

Если вы хотите разместить небольшое количество картинок, вы можете воспользоваться любым фотохостингом, например: [imgbb]({{ imgbb }}) или [ImageShack]({{ imageshack }}). Так вы сможете быстро получить прямые ссылки на ваши картинки, которые можно добавить в файл с заданиями или в инструкцию.

{% endnote %}

Если для ваших заданий нужны картинки или другие файлы, разместите их на [Яндекс Диске]({{ yadisk }}). Вы можете использовать файлы только с Яндекс Диска того же аккаунта, с которым вы работаете в Толоке.

Чтобы использовать файлы с Яндекс Диска в заданиях:

1. [Подключите Яндекс Диск](#connect).

1. [Добавьте ссылки на файлы в интерфейс задания](#interface).

1. [Добавьте ссылки на файлы в инструкцию](#instruction).

## Подключить Яндекс Диск {#connect}

Чтобы использовать Яндекс Диск в качестве источника данных:

1. Нажмите кнопку **Подключить Яндекс Диск** на вкладке [Интеграция]({{ integration }}) на странице [профиля]({{ profile }}) и разрешите Толоке доступ к Яндекс Диску.

1. Нажмите кнопку **Добавить прокси** и заполните поля:

    #|
    ||**Поле**|**Описание**||
    ||**Уникальное имя**|Название источника данных. Будет включено в URL-путь к файлам. Допустимые символы в названии: латинские буквы, цифры, дефис «-».

    Должно быть уникально в рамках Толоки.||
    ||**Тип**| Выберите «Яндекс Диск».||
    ||**Права доступа**| Уровень доступа к файлам:

    - «Публичный» — всем исполнителям Толоки (подходит для файлов инструкций).

    - «Приватный» — только исполнителям, которые получили задание с данным файлом (подходит для контента заданий).||
    ||**Название папки**| Название папки на Яндекс Диске. в названии папки нельзя использовать слеш («/»).

    Папка с этим названием будет создана на Яндекс Диске автоматически: `Приложения/Toloka/<имя папки>`).||
    |#

1. Нажмите **Сохранить**.

1. Загрузите файлы для заданий или инструкций в созданную папку на Яндекс Диске. Она будет находиться по адресу `Приложения/Toloka/<имя папки>` (имя вы указали в поле ).

## Добавить файлы в интерфейс задания {#interface}

Чтобы добавить файл в [интерфейс задания](spec.md):

{% list tabs %}

- Конструктор шаблонов

  1. Выберите тип компонента. Например, `"view.image"` — для вставки картинки, `"view.audio"` — аудио, `"view.video"` — видео.

  1. В свойстве `"url"` компонента выберите тип `"@toloka/helper.proxy"`.

  1. В свойстве `"path"` компонента укажите конструкцию вида `/<имя прокси>/<имя файла>.<тип>` со своими данными.

  [Посмотреть пример с классификацией изображений](https://ya.cc/t/U35lM1hi3ttEbC)

  {% note tip %}

  Чтобы не вводить путь к файлу вручную, скопируйте поле **URL** из вкладки [Интеграция]({{ integration }}) и замените название и тип файла.

  {% endnote %}

  Пример добавления файлов с Яндекс Диска в конструкторе шаблонов:

  ```json
  {
  "type": "view.image",
  "url": {
    "type": "@toloka/helper.proxy",
    "path": "/my-proxy/example.jpg"
    }
  }
  ```

  Вы также можете вынести ссылки на файлы вида `/<имя прокси>/<имя файла>.<тип>` во входные данные и сослаться на них в конфигурации.

  {% cut "Одно изображение" %}

  ```json
  {
  "type": "view.image",
  "url": {
    "type": "@toloka/helper.proxy",
    "path": {
      "type": "data.input",
      "path": "image"
      }
    }
  }
  ```

  [Посмотреть пример в песочнице](https://ya.cc/t/7LC4AVi53ttA9S)

  {% endcut %}

  {% cut "Несколько изображений" %}

  {% note tip %}

  Не забывайте, что элементы массива начинаются с нуля.

  {% endnote %}

  ```json
  {
  "type": "view.image",
  "url": {
    "type": "@toloka/helper.proxy",
    "path": {
      "type": "data.input",
      "path": "images.0"
      }
    }
  }
  ```

  [Посмотреть пример в песочнице](https://ya.cc/t/_XrwbL4V3ttEhW)

  {% endcut %}

- Редактор интерфейсов HTML/JS/CSS

  1. Укажите тип данных **строка** для [поля входных данных](incoming.md), в котором вы будете передавать ссылку на файл.

  1. Вставьте файл. Обратите внимание на формат, в котором указывается имя поля: `proxy <поле со ссылкой на файл>`

      {% cut "Картинка" %}

      Добавьте картинку в блоке HTML одним из способов:

      - С помощью компонента [Картинка](t-components/img.md): `{{img src=(proxy image)}}`.

      - С помощью HTML-тега: `<img src="not_var{{proxy image}}">`.

      {% endcut %}

      {% cut "Аудио или видео" %}

      Добавьте HTML-тег:

      - для вставки аудиозаписи в плеере: `<audio src="not_var{{proxy audio}}" controls>`;

      - для вставки видеозаписи в плеере: `<video src="not_var{{proxy video}}" controls>`.

      {% endcut %}

      {% cut "Редактор для выделения области на картинке" %}

      Добавьте [компонент](t-components/image-annotation.md#adding_editor)`{{field type="image-annotation" name="result" src=(proxy image)}}`.

      {% endcut %}

  1. Приведите относительные ссылки на файлы Яндекс Диска в  вида `/<имя прокси>/<имя папки>/<имя файла>.<тип>`. Например, `/my-proxy/example.jpg` или с названием папки — `/my-proxy/photos/example.jpg`.

      {% note info %}

      Обратите внимание, что название папки нужно не всегда. Иногда достаточно имени прокси и названия файла через "/".

      {% endnote %}

{% endlist %}

## Добавить файлы в инструкцию {#instruction}

{% note alert %}

Тип прав доступа на папку с файлами для инструкций нужно установить «Публичный».

{% endnote %}

Чтобы добавить картинку в [инструкцию проекта](instruction.md):

1. Загрузите файлы в папку `Приложения/Толока/<имя папки>` через [веб-интерфейс]({{ yadisk-client }) или с помощью приложения [Яндекс Диск]({{ yadisk-app }).

1. Выберите способ добавления файла в инструкцию.

    {% list tabs %}

    - Визуальный редактор

      1. В поле **Инструкция для исполнителей** на панели инструментов нажмите значок ![](../_images/img3.svg).

      1. Вставьте конструкцию вида `/api/proxy/<имя прокси>/<имя файла>.<тип>` в появившееся поле. Например: `/api/proxy/my-proxy/example.jpg`.

      1. Нажмите клавишу **Enter**.

    - Используйте ссылки

      1. На панели инструментов нажмите значок ![](../_images/code.svg).

      1. Добавьте HTML-тег `<img src="/api/proxy/<имя прокси>/<имя файла>.<тип>">` в поле ввода. Например: `<img src="/api/proxy/my-proxy/example.jpg">`.

    {% endlist %}

## Решение проблем {#troubleshooting}

{% cut "Не загружаются файлы с Яндекс Диска" %}

Если картинки, аудио или видео с Яндекс Диска не отображаются в [инструкции](../../glossary.md#instructions) или на [странице задания](../../glossary.md#task-suite), убедитесь, что вы правильно подключили Диск и загрузили файлы.

- [Как подключить Яндекс Диск](../concepts/prepare-data.md#prepare-data__connect)
- [Как загрузить файлы для инструкции](../concepts/prepare-data.md#prepare-data__instruction)
- [Как загрузить файлы для задания](../concepts/prepare-data.md#prepare-data__interface)

{% cut "Как сделать задание, в котором исполнитель должен просматривать видео с Яндекс Диска?" %}

Для создания задания возьмите за основу [шаблон для разметки видео]({{ templates-video-new }}).

Чтобы разместить ваши видеоролики на Яндекс Диске, его нужно подключить и настроить проект.

Подробная видеоинструкция об этом [в нашем блоге]({{ toloka-blog-yadisk }}).

{% endcut %}

{% cut "Почему в задании по выделению объектов на изображении не отображаются изображения с Яндекс Диска?" %}

Проблема в шаблоне задания. Проверьте, что:

- Для поля входных данных, куда вы передаете ссылку на файл, в проекте указан тип «строка».

- В компоненте в шаблоне задания используется выражение proxy.

- Формат относительных ссылок в файле с заданиями указан верно: <уникальное имя>/<путь и имя файла>.

Подробная инструкцию и видео на странице [Использование файлов с Яндекс Диска](prepare-data.md).

{% endcut %}

{% cut "Частые ошибки при подключении Диска и загрузке файлов" %}

- В настройках проекта в поле **Входные данные** указан тип _ссылка_. Необходимо выбрать тип _строка_.

- В [файле с заданиями](../../glossary.md#tsv) указаны абсолютные ссылки на файлы для заданий. Необходимо вставить ссылку вида `<уникальное имя>/<путь и имя файла>`. Например: `yadisk/image1.jpg` или `yadisk/photos/image1.png`.

- Фото с Яндекс Диска используются в инструкции к заданию в мобильном приложении. Чтобы фото отобразилось в инструкции, используйте только прямые ссылки.

- Файлы удалены или находятся не в той папке на Диске, на которую ведет ссылка.

- OAuth-токен не активен. Обновите токен на странице [Интеграция]({{ integration }}).

Чтобы файлы, загруженные на Яндекс Диск (картинки, аудио, видео), отображались у исполнителя, нужно:

1. Подключить Яндекс Диск в профиле.

1. Установить тип строка для поля [входных данных](../../glossary.md#input-output-data).

1. Вставлять ссылку на файл при помощи компонента `proxy`.

[Подробная инструкция](../concepts/prepare-data.md)

{% endcut %}

{% endcut %}

{% cut "Как сделать задание, в котором исполнитель должен просматривать видео с Яндекс Диска?" %}

Для создания задания возьмите за основу [шаблон для разметки видео]({{ templates-video-new }}).

Чтобы разместить ваши видеоролики на Яндекс Диске, его нужно подключить и настроить проект.

Подробная видеоинструкция об этом [в нашем блоге]({{ toloka-blog-yadisk }}).

{% endcut %}

{% cut "Почему в задании по выделению объектов на изображении не отображаются изображения с Яндекс Диска?" %}

Проблема в шаблоне задания. Проверьте, что:

- Для поля входных данных, куда вы передаете ссылку на файл, в проекте указан тип «строка».

- В компоненте в шаблоне задания используется выражение proxy.

- Формат относительных ссылок в файле с заданиями указан верно: <уникальное имя>/<путь и имя файла>.

Подробная инструкцию и видео на странице [Использование файлов с Яндекс Диска](prepare-data.md).

{% endcut %}

{% cut "Файлы на Яндекс Диск загружаются слишком медленно. Как ускорить загрузку?" %}

Попробуйте воспользоваться рекомендациями с [этой страницы]({{ yadisk-uploading }}) или написать в службу поддержки Яндекс Диска.

{% endcut %}

{% cut "Как в инструкцию встроить несколько картинок с Яндекс Диска?" %}

Чтобы добавить картинки с помощью ссылок на Яндекс Диск, используйте ссылку вида `/api/proxy/<имя прокси>/<имя файла>.<тип>`. Например: `/api/proxy/my-proxy/example.jpg`

Подробнее об этом читайте в разделе [Добавить файлы в инструкцию](../concepts/prepare-data.md).

{% endcut %}

{% cut "Почему в предпросмотре заданий не отображаются изображения с Яндекс Диска?" %}

Проблема в шаблоне задания. Проверьте, что:

- Для поля входных данных, куда вы передаете ссылку на файл, в проекте указан тип «строка».

- В компоненте в шаблоне задания используется выражение proxy.

- Формат относительных ссылок в файле с заданиями указан верно: <уникальное имя>/<путь и имя файла>.

Подробная [инструкция и видео](../concepts/prepare-data.md).

{% endcut %}

{% cut "Как в задание добавить видео, которое размещено на Яндекс Диске?" %}

Можно взять за основу шаблон [для разметки видео]({{ templates-video }}).

Чтобы разместить ваши видеоролики на Яндекс Диске, его нужно подключить и настроить проект.

Подробная видеоинструкция есть в нашем [блоге]({{ toloka-blog-yadisk }}).

{% endcut %}

Если эти рекомендации не помогли:

{% include [contact-support](../_includes/contact-support.md) %}

{% include [image-styles](../../../_includes/image-styles-internal.md) %}