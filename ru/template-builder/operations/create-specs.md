# Создание спецификации

В Яндекс Толоке в настройках проекта должна быть указана спецификация [входных и выходных данных](../glossary.md#input-output-data). Если вы используете конструктор шаблонов в интерфейсе Толоки, то спецификация создается автоматически.

{% note alert %}

Создание спецификации работает в тестовом режиме — перепроверяйте результат. Если возникнут проблемы, обратитесь в [службу поддержки](../concepts/support.md).

{% endnote %}

## Заполнение входных данных {#input-data-create}

Поля входных данных создаются из кода на вкладке **Пример входных данных**. Указывайте максимально подробный пример, чтобы получить готовую спецификацию. Например, если есть необязательные поля, укажите и их.

**Примеры:**

{% list tabs %}

- Строка

  В этом примере в спецификации будет создано поле `question` с типом **строка**.

  ```json
  {
    "question": "Do you like dogs?"
  }
  ```

- true/false

  В этом примере в спецификации будет создано поле `verdict` с типом **логический**.

  ```json
  {
    "verdict": true
  }
  ```

- Число

  В этом примере в спецификации будет создано поле `age` с типом **число**.

  ```json
  {
    "age": 42
  }
  ```

- JSON

  В этом примере в спецификации будет создано поле `registration_аddress` с типом **JSON**.

  ```json
  {
      ...
      "registration_аddress": {
          "country": "Russia",
          "city": "Moscow",
          "address": "Tverskaya str, 3-53"
      }
  }
  ```

- Массив

  В этом примере в спецификации будет создано поле `images` с типом **массив**.

  ```json
  {
    "images": [
      "https://cdn.stocksnap.io/img-thumbs/960w/surfer-wave_3DBOYBPB3X.jpg",
      "https://cdn.stocksnap.io/img-thumbs/960w/fisherman-silhouette_UADULRRHEK.jpg",
      "https://cdn.stocksnap.io/img-thumbs/960w/old-photo_GEQ27OWZVV.jpg"
    ]
  }
  ```

{% endlist %}

{% note info %}

По умолчанию все поля входных данных в спецификации помечаются обязательными. Чтобы сделать поле необязательным, надо в конфигурации в компоненте [data.input](work-with-data.md) задать свойство `default`.

{% endnote %}


## Заполнение выходных данных {#output-data-create}

Поля выходных данных создаются на основе того, в каких компонентах используется `data.output`, а также какие значения в нем разрешены.

**Примеры:**

{% list tabs %}

- true/false

  В этом примере в спецификации будет поле `verdict` с типом **логический**.

  ```json
  {
    "type": "field.radio-group",
    "options": [
      {
        "label": "Да",
        "value": true
      },
      {
        "label": "Нет",
        "value": false
      }
    ],
    "data": {
      "type": "data.output",
      "path": "verdict"
    }
  }
  ```

- Строка

  В этом примере в спецификации будет поле `verdict` с типом **строка** и допустимыми значениями "true", "false".

  ```json
  {
    "type": "field.radio-group",
    "options": [
      {
        "label": "Да",
        "value": "true"
      },
      {
        "label": "Нет",
        "value": "false"
      }
    ],
    "data": {
      "type": "data.output",
      "path": "verdict"
    }
  }
  ```

- Число

  В этом примере в спецификации будет поле `verdict` с типом **число** и допустимыми значениями `0` и `1`.

  ```json
  {
    "type": "field.radio-group",
    "options": [
      {
        "label": "Да",
        "value": 1
      },
      {
        "label": "Нет",
        "value": 0
      }
    ],
    "data": {
      "type": "data.output",
      "path": "verdict"
    }
  }
  ```

- JSON

  В этом примере в спецификации будет поле `results` с типом **JSON**. В поле `results` будет записан JSON-объект `{ "verdict": true }` или `{ "verdict": false }`.

  ```json
  {
    "type": "field.radio-group",
    "options": [
      {
        "label": "Да",
        "value": true
      },
      {
        "label": "Нет",
        "value": false
      }
    ],
    "data": {
      "type": "data.output",
      "path": "results.verdict"
    }
  }
  ```

- Массив

  В этом примере в спецификации будет поле `verdicts` с типом **массив**.

  ```json
  {
    "type": "field.radio-group",
    "options": [
      {
        "label": "Да",
        "value": 1
      },
      {
        "label": "Нет",
        "value": 0
      }
    ],
    "data": {
      "type": "data.output",
      "path": "verdicts.0"
    }
  }
  ```

{% endlist %}

{% note info %}

Если в выходных данных будут значения разных типов, то в спецификации будет указан тип **JSON**.

{% endnote %}


## Как редактировать спецификацию {#manual-setting}

Вы можете изменить спецификацию в настройках проекта Яндекс Толоки двумя способами: в обычном режиме или в режиме JSON. Режим JSON дает больше возможностей: вы можете делать скрытыми входные данные и использовать регулярные выражения для валидации выходных данных.
{% list tabs %}

- Обычный режим

  Чтобы добавить поле в обычном режиме, нажмите кнопку **Добавить поле**.

  Чтобы редактировать существующее поле, наведите курсор на поле и нажмите кнопку ![](../_images/edit.svg).

- Режим JSON

  Для переключения режима нажмите кнопку ![](../_images/code.svg). Примеры полей:

  **Примеры полей**

  {% cut "Текст в разных форматах" %}

  - Строка определенной длины

      ```json
      "my_string": {
          "type": "string",
          "required": true,
          "min_length": 10,
          "max_length": 100
      }
      ```


  - Только русские буквы и цифры
  
      ```json
      "my_ru_string": {
          "type": "string",
          "required": true,
          "min_length": 10,
          "max_length": 100,
          "pattern": "[а-яА-Я0-9]+"
      }
      ```

  - Только латинские буквы и цифры
  
      ```json
      "my_en_string": {
          "type": "string",
          "required": true,
          "min_length": 10,
          "max_length": 100,
          "pattern": "[a-zA-Z0-9]+"
      }
      ```

  - Буквы и символы без цифр
  
      ```json
      "my_number_string": {
          "type": "string",
          "required": true,
          "min_length": 10,
          "max_length": 100,
          "pattern": "[^0-9]+"
      }
      ```

  - Ссылка с определенного сайта
  
      ```json
      "my_url": {
          "type": "string",
          "required": true,
          "pattern": "(?:http(?:s)?:\\/\\/)?(?:[a-zA-z-]+(\\.)+)*(?:yandex\\.ru){1}(\\/|\\/[a-zA-Z-\\._~:/\\?#\\[\\]@!\\$&'\\(\\)\\*\\+,;=]+)?"
      }
      ```

  - Номер телефона с символами `+`, `-` и пробелом
  
      ```json
      "my_phone_string": {
          "type": "string",
          "required": true,
          "pattern": "\\+?[0-9\\s-]{4,}"
      }
      ```

  - Электронная почта с символами `@`, `-` и `.`
  
      ```json
      "my_mail_string": {
          "type": "string",
          "required": true,
          "pattern": "[a-zA-Z]{1}[a-zA-Z0-9\\.\\-_]+@[a-zA-Z0-9\\.\\-_]+\\.[a-zA-Z]{2,}"
      }
      ```

  - Месяц
  
      ```json
      "my_month_string": {
          "type": "string",
          "required": true,
          "allowed_values": ["январь", "февраль", "март", "апрель", "май", "июнь", "июль", "август", "сентябрь", "октябрь" "ноябрь", "декабрь"]
      }
      ```

  {% endcut %}

  {% cut "Ссылка" %}


  ```json
  "my_url": {
      "type": "url",
      "required": true
  }
  ```

  {% endcut %}

  {% cut "Логический тип данных" %}

  ```json
  "my_boolean": {
      "type": "boolean",
      "required": true
  }
  ```

  {% endcut %}

  {% cut "Числа" %}

  - Целое число из указанного диапазона:
  
      ```json
      "my_integer": {
          "type": "integer",
          "required": true,
          "min_value": 1,
          "max_value": 100
      }
      ```

  - Целое число со списком допустимых значений:
  
      ```json
      "my_integer": {
          "type": "integer",
          "required": true,
          "allowed_values": [10, 20, 30]
      }
      ```

  - Дробное число:
  
      ```json
      "my_float": {
          "type": "float",
          "required": true,
          "min_value": 10.11,
          "max_value": 65.51
      }
      ```

  - Число с 0, 1 или 2 знаками после запятой.

      Для этого надо выбрать тип **строка** и проверять с помощью регулярного выражения. Обратите внимание, что разделитель дробной части — запятая:
      
      ```json
      "my_mail_string": {
          "type": "string",
          "required": true,
          "pattern": "^([0-9]+)(,([0-9]){1,2})?$"
      }
      ```


  {% endcut %}

  {% cut "Файл" %}

  ```json
  "my_file": {
      "type": "file",
      "required": true
  }
  ```

  {% endcut %}

  {% cut "Массив файлов" %}

  ```json
  "my_file_array": {
      "type": "array_file",
      "required": true,
      "max_size": 5
  }
  ```

  {% endcut %}

  {% cut "Географические координаты" %}

  ```json
  "my_coordinates": {
      "type": "coordinates",
      "required": true
  }
  ```

  {% endcut %}

  {% cut "JSON" %}

  ```json
  "my_json": {
      "type": "json",
      "required": true
  }
  ```

  {% endcut %}

  {% cut "Скрытое поле" %}

  Строка, к которой исполнитель не сможет получить доступ:
  ```json
  "my_string": {
      "type": "string",
      "hidden": true
  }
  ```

  {% endcut %}

{% endlist %}

{% cut "Пояснения к настройке полей" %}

#|
||**Параметр**|**Параметр в JSON**|**Описание**||
||**Название**|`id`|Идентификатор поля. Допустимы латинские буквы, цифры, дефис и нижнее подчеркивание.||
||**Тип**|`type`|Тип данных:

- строка — `string`;

- ссылка — `url`;

- логический — `boolean`;

- число — `number`;

- дробное число — `float`;

- файл — `file`;
- географические координаты — `coordinates`;

- объект JSON — `json`.


Для массивов в режиме JSON к типу добавляется префикс `array_`. Например: `array_file`.||
||**Обязательное поле**|`required`|Обязательность объекта при загрузке заданий для входных данных.

Обязательность ответа исполнителя для выходных данных.

По умолчанию поле необязательное — `false`.||
||**Скрытое поле**|`hidden`|Позволяет скрыть данные от исполнителя. Если этого не сделать, исполнители могут получить значение поля программно. Параметр можно настроить в режиме JSON.

Например, вы можете скрыть идентификатор `assigment_id`, который вам понадобится при выполнении отложенной приемки в отдельном проекте.

{% cut "Отложенная приемка" %}

Параметр настройки [пула](../glossary.md#pool), который позволяет проверять ответы и при этом не платить за задания, которые исполнители сделали некачественно.

{% endcut %}

По умолчанию поле открытое — `false`.

{% note alert %}

Скрытые поля недоступны в интерфейсе задания, даже через JS или код шаблона в конструкторе.

{% endnote %}||
||**Массив**|`array_<тип>`|Массив объектов одного типа. Используется, например, для загрузки нескольких фотографий исполнителем.
В режиме JSON массив — это отдельный тип данных. Например: `"type": "array_file"`.||
||**Мин. элементов**|`min_size`|Минимальное число элементов в массиве.||
||**Макс. элементов**|`max_size`|Максимальное число элементов в массиве.||
||**Допустимые значения**|`allowed_values`|Допустимые значения для строк, дробных и целых чисел, логического типа данных.||
||**Мин. длина**|`min_length`|Минимальная длина строки.||
||**Макс. длина**|`max_length`|Максимальная длина строки.||
||**Мин. значение**|`min_value`|Минимальное значений для дробных и целых чисел.||
||**Макс. значение**|`max_value`|Максимальное значений для дробных и целых чисел.||
||**Текущее положение**|`current_location`|Сохранение текущих координат исполнителя (`true`/`false`). Только для типа данных `coordinates`. Используется в заданиях для мобильного приложения.

По умолчанию `false`.||
||**Шаблон**|`pattern`|Регулярное выражение, которому должна соответствовать строка. Параметр можно настроить в режиме JSON.||
|#

{% endcut %}


## Рекомендации {#recomendations}

- Если вы редактируете обязательные поля, изменения применятся только к новым [пулам](../glossary.md#pool) заданий. Например, если вам пришлось исправить ошибку в проекте, [клонируйте пул](https://toloka.ai/ru/docs/guide/concepts/pool-main.html) или [создайте новый](https://toloka.ai/ru/docs/guide/concepts/pool-main.html). Существующие пулы заданий будут работать в соответствии со старой версией проекта.

- В выходных данных используйте проверку значений и не забывайте помечать поле обязательным, если исполнитель всегда должен заполнить его.
- Скрытые поля нужны только заказчикам и недоступны в интерфейсе задания. Значения скрытых полей невозможно использовать ни в JS-коде, ни в конструкторе шаблонов.

    Например, вы передаете в задании служебные данные товара, которые не нужны исполнителям: артикул или номер партии. Или вы модерируете комментарии и вам нужны в результатах персональные данные авторов для последующей обработки данных, но исполнители не должны иметь к ним доступ.

    Чтобы создать скрытое поле, добавьте его в спецификацию самостоятельно, затем в режиме JSON добавьте к этому полю параметр `"hidden": true`. Эти действия надо выполнять в Толоке при настройке проекта. Скрытое поле сохранится при повторной генерации спецификации с помощью Конструктора шаблонов.


## Что дальше {#what-next}

- [Посмотрите примеры чтения и записи в данные](input-output-data.md).
- [Узнайте, как очистить введенные данные](clear-data.md).


[![](../_images/buttons/contact-support.svg)](../concepts/support.md)
